<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="theme-color" content="#c9553d" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="description" content="1週間の晩ごはんを決めて、買い物リストを自動作成。お気に入りレシピを登録して、毎週の献立づくりをラクに。" />
    <title>Kondate Loop | 1週間の献立と買い物リスト</title>
    <link rel="stylesheet" href="styles.css" />
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>🥘</text></svg>" />
  </head>
  <body>
    <div class="background-shape" aria-hidden="true"></div>
    <div class="background-shape background-shape--alt" aria-hidden="true"></div>

    <div class="page">
      <!-- Landing Section -->
      <section class="landing" id="landing" aria-labelledby="landingTitle">
        <div class="landing__hero">
          <p class="eyebrow">Weekly Dinner Planner</p>
          <h1 id="landingTitle">Kondate Loop</h1>
          <p class="landing__lead">
            1週間の晩ごはん、<br />
            <strong>まとめて決めて、まとめて買い出し。</strong><br />
            毎日「今日何作ろう」がなくなる。
          </p>
          <div class="landing__actions">
            <button type="button" class="button--primary" id="enterApp">
              今週の献立を決める
            </button>
            <button type="button" class="button--ghost" id="enterRecipes">
              レシピを登録する
            </button>
            <p class="landing__note">アカウント登録不要・この端末だけに保存</p>
          </div>
        </div>

        <div class="landing__overview">
          <div class="landing__grid">
            <article class="landing__card">
              <span class="landing__card-icon">📝</span>
              <h2>好きなレシピを登録</h2>
              <p>よく作る料理、お気に入りのレシピURLを保存。いつでも呼び出せる自分だけのメニュー帳に。</p>
            </article>
            <article class="landing__card">
              <span class="landing__card-icon">📅</span>
              <h2>1週間まとめて計画</h2>
              <p>月〜日の晩ごはんを一覧で決められる。週末にまとめて買い出しも、その日に買い足しも自由。</p>
            </article>
            <article class="landing__card">
              <span class="landing__card-icon">🛒</span>
              <h2>買い物リスト自動作成</h2>
              <p>選んだレシピの食材を自動で集計。人数に合わせて分量も計算。スマホで見ながら買い物できる。</p>
            </article>
            <article class="landing__card">
              <span class="landing__card-icon">🔄</span>
              <h2>予定変更もかんたん</h2>
              <p>外食が入った日は献立を消すだけ。買い物リストも自動で更新されるから、ムダな買い物なし。</p>
            </article>
          </div>

          <div class="landing__steps">
            <h2>3ステップで使える</h2>
            <ol class="steps">
              <li><strong>レシピ登録</strong> — よく作る料理の材料を登録（URLから自動取得も可）</li>
              <li><strong>献立を決める</strong> — 曜日ごとにレシピを選んで1週間分を計画</li>
              <li><strong>買い物リストで買い出し</strong> — 必要な食材と分量を見ながらお買い物</li>
            </ol>
          </div>
        </div>
      </section>

      <!-- App Section (献立) -->
      <section class="app" id="app" hidden>
        <div class="app__nav">
          <button type="button" class="button--ghost button--small" id="backToLanding">
            使い方
          </button>
          <button type="button" class="button--ghost button--small" id="openRecipesFromApp">
            メニュー一覧
          </button>
        </div>

        <header class="hero">
          <div class="hero__text">
            <p class="eyebrow">Dinner Only</p>
            <h1>1週間の晩ご飯</h1>
            <p class="hero__lead">
              1食に複数品を並べて選び、<br />
              買い物リストは自動生成。
            </p>
          </div>
          <div class="hero__meta">
            <div class="meta__item">
              <span class="meta__label">保存</span>
              <span class="meta__value">ローカルストレージ</span>
            </div>
            <div class="meta__item">
              <span class="meta__label">週の起点</span>
              <span class="meta__value">月曜日</span>
            </div>
            <div class="meta__item">
              <span class="meta__label">買い物</span>
              <span class="meta__value">自動生成</span>
            </div>
            <div class="meta__item">
              <span class="meta__label">メニュー</span>
              <span class="meta__value">URL + 食材</span>
            </div>
          </div>
        </header>

        <section class="controls">
          <div class="controls__left">
            <label class="control" for="weekStart">
              <span>週の開始日</span>
              <input id="weekStart" type="date" />
            </label>
            <div class="controls__buttons">
              <button type="button" id="prevWeek">前週</button>
              <button type="button" class="button--primary" id="thisWeek">今週</button>
              <button type="button" id="nextWeek">次週</button>
            </div>
          </div>
          <div class="controls__right">
            <div class="week-range" id="weekRange"></div>
            <div class="save-status" id="saveStatus">保存済み</div>
            <button type="button" class="button--ghost button--small" id="clearWeek">クリア</button>
          </div>
        </section>

        <main class="app-content">
          <section class="checklist" aria-labelledby="shoppingTitle">
            <div class="checklist__header">
              <div>
                <p class="eyebrow">Shopping List</p>
                <h2 id="shoppingTitle">食材リスト</h2>
                <p class="checklist__lead">
                  選んだレシピの食材を人数に合わせて集計
                </p>
              </div>
            </div>
            <ul class="checklist__list" id="shoppingList"></ul>
            <p class="checklist__empty" id="shoppingEmpty">
              レシピを選択すると買い物リストが表示されます
            </p>
          </section>

          <section class="week-grid" id="weekGrid" aria-live="polite"></section>
        </main>

        <footer class="footer">
          <p>
            入力は自動保存。週を切り替えると記録と食材リストが復元されます。
          </p>
        </footer>
      </section>

      <!-- Recipe Modal -->
      <div class="modal" id="recipeModal" hidden>
        <div class="modal__backdrop" id="recipeModalBackdrop"></div>
        <div
          class="modal__panel"
          role="dialog"
          aria-modal="true"
          aria-labelledby="recipeModalTitle"
        >
          <div class="modal__header">
            <h2 id="recipeModalTitle">レシピを登録</h2>
            <button
              type="button"
              class="button--ghost button--small"
              id="recipeModalClose"
            >
              閉じる
            </button>
          </div>
          <form id="recipeModalForm" class="modal__body">
            <label class="form-field" for="recipeModalName">
              <span>レシピ名</span>
              <input id="recipeModalName" type="text" required />
            </label>
            <div class="form-field form-field--with-button">
              <span>URL（任意）</span>
              <div class="input-with-button">
                <input id="recipeModalUrl" type="url" placeholder="https://..." />
                <button type="button" class="button--ghost button--small" id="recipeModalFetch">
                  URLから取得
                </button>
                <button type="button" class="button--ghost button--small" id="recipeModalTextToggle">
                  テキストから
                </button>
              </div>
              <p class="form-field__help" id="recipeModalFetchStatus"></p>
              <div class="text-parse-area" id="recipeModalTextArea" hidden>
                <textarea id="recipeModalTextInput" placeholder="ツイートやレシピのテキストを貼り付け..." rows="4"></textarea>
                <button type="button" class="button--ghost button--small" id="recipeModalTextParse">
                  テキストを解析
                </button>
              </div>
            </div>
            <label class="form-field" for="recipeModalServings">
              <span>基準人数</span>
              <select id="recipeModalServings">
                <option value="1">1人前</option>
                <option value="2" selected>2人前</option>
                <option value="3">3人前</option>
                <option value="4">4人前</option>
              </select>
            </label>
            <div class="form-field">
              <span>タグ（出典、ジャンルなど）</span>
              <div class="tag-input-wrapper">
                <div class="tag-list" id="recipeModalTagList"></div>
                <input id="recipeModalTagInput" type="text" placeholder="タグを入力してEnter" />
              </div>
            </div>
            <div class="form-field">
              <span>食材（1行ごとに追加）</span>
              <div class="ingredient-list__header">
                <span>食材名</span>
                <span>数量</span>
                <span>単位</span>
                <span aria-hidden="true"></span>
              </div>
              <div class="ingredient-list" id="recipeModalIngredientList"></div>
              <button
                type="button"
                class="button--ghost button--small"
                id="recipeModalIngredientAdd"
              >
                + 食材を追加
              </button>
            </div>
            <label class="form-field" for="recipeModalInstructions">
              <span>作り方メモ</span>
              <textarea id="recipeModalInstructions" rows="6" placeholder="1. 材料を切る&#10;2. フライパンで炒める&#10;3. 調味料を加える"></textarea>
            </label>
            <div class="recipe-form__actions">
              <button type="submit" class="button--primary">登録</button>
              <button type="button" class="button--ghost" id="recipeModalCancel">
                キャンセル
              </button>
            </div>
          </form>
        </div>
      </div>

      <!-- Recipe DB Section -->
      <section class="recipe-db" id="recipes" hidden>
        <div class="app__nav">
          <button
            type="button"
            class="button--ghost button--small"
            id="backToLandingFromRecipes"
          >
            使い方
          </button>
          <button
            type="button"
            class="button--ghost button--small"
            id="openAppFromRecipes"
          >
            献立へ戻る
          </button>
        </div>

        <header class="hero">
          <div class="hero__text">
            <p class="eyebrow">Menu Collection</p>
            <h1>メニュー一覧</h1>
            <p class="hero__lead">
              URLと食材を登録し、献立の候補に。
            </p>
          </div>
          <div class="hero__meta">
            <div class="meta__item">
              <span class="meta__label">保存</span>
              <span class="meta__value">ローカルストレージ</span>
            </div>
            <div class="meta__item">
              <span class="meta__label">検索</span>
              <span class="meta__value">料理名・食材名</span>
            </div>
            <div class="meta__item">
              <span class="meta__label">URL取得</span>
              <span class="meta__value">JSON-LD対応</span>
            </div>
            <div class="meta__item">
              <span class="meta__label">連携</span>
              <span class="meta__value">献立に自動反映</span>
            </div>
          </div>
        </header>

        <main class="recipe-db__content">
          <section class="recipe-form">
            <h2 id="recipeFormTitle">レシピを登録</h2>
            <form id="recipeForm" class="recipe-form__body">
              <label class="form-field" for="recipeName">
                <span>レシピ名</span>
                <input id="recipeName" type="text" required />
              </label>
              <div class="form-field form-field--with-button">
                <span>URL（任意）</span>
                <div class="input-with-button">
                  <input id="recipeUrl" type="url" placeholder="https://..." />
                  <button type="button" class="button--ghost button--small" id="recipeFetch">
                    URLから取得
                  </button>
                  <button type="button" class="button--ghost button--small" id="recipeTextToggle">
                    テキストから
                  </button>
                </div>
                <p class="form-field__help" id="recipeFetchStatus"></p>
                <div class="text-parse-area" id="recipeTextArea" hidden>
                  <textarea id="recipeTextInput" placeholder="ツイートやレシピのテキストを貼り付け..." rows="4"></textarea>
                  <button type="button" class="button--ghost button--small" id="recipeTextParse">
                    テキストを解析
                  </button>
                </div>
              </div>
              <label class="form-field" for="recipeServings">
                <span>基準人数</span>
                <select id="recipeServings">
                  <option value="1">1人前</option>
                  <option value="2" selected>2人前</option>
                  <option value="3">3人前</option>
                  <option value="4">4人前</option>
                </select>
              </label>
              <div class="form-field">
                <span>タグ（出典、ジャンルなど）</span>
                <div class="tag-input-wrapper">
                  <div class="tag-list" id="recipeTagList"></div>
                  <input id="recipeTagInput" type="text" placeholder="タグを入力してEnter" />
                </div>
                <p class="form-field__help">例: クラシル, 和食, 作り置き, 時短</p>
              </div>
              <div class="form-field">
                <span>食材（1行ごとに追加）</span>
                <div class="ingredient-list__header">
                  <span>食材名</span>
                  <span>数量</span>
                  <span>単位</span>
                  <span aria-hidden="true"></span>
                </div>
                <div class="ingredient-list" id="ingredientList"></div>
                <button
                  type="button"
                  class="button--ghost button--small"
                  id="ingredientAdd"
                >
                  + 食材を追加
                </button>
              </div>
              <label class="form-field" for="recipeInstructions">
                <span>作り方メモ</span>
                <textarea id="recipeInstructions" rows="6" placeholder="1. 材料を切る&#10;2. フライパンで炒める&#10;3. 調味料を加える"></textarea>
              </label>
              <div class="recipe-form__actions">
                <button type="submit" class="button--primary" id="recipeSave">
                  登録
                </button>
                <button type="button" class="button--ghost" id="recipeCancel" hidden>
                  キャンセル
                </button>
              </div>
            </form>
          </section>

          <section class="recipe-list">
            <div class="recipe-list__header">
              <h2>メニュー表</h2>
              <input
                id="recipeSearch"
                type="search"
                placeholder="料理名・食材・タグで検索"
                autocomplete="off"
              />
            </div>
            <div class="tag-filter" id="tagFilter">
              <span class="tag-filter__label">タグで絞り込み:</span>
              <div class="tag-filter__list" id="tagFilterList"></div>
            </div>
            <div class="recipe-list__items" id="recipeList"></div>
            <p class="recipe-list__empty" id="recipeEmpty">
              まだメニューがありません
            </p>
          </section>
        </main>
      </section>
    </div>

    <div class="loading-overlay" id="loadingOverlay" hidden>
      <div class="loading-spinner"></div>
      <p class="loading-text" id="loadingText">解析中...</p>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-nav" id="mobileNav" hidden aria-label="メインナビゲーション">
      <button type="button" class="mobile-nav__item" data-nav="kondate" aria-current="page">
        <span class="mobile-nav__icon">📅</span>
        <span class="mobile-nav__label">献立</span>
      </button>
      <button type="button" class="mobile-nav__item" data-nav="shopping">
        <span class="mobile-nav__icon">🛒</span>
        <span class="mobile-nav__label">買い物</span>
      </button>
      <button type="button" class="mobile-nav__item" data-nav="recipes">
        <span class="mobile-nav__icon">📝</span>
        <span class="mobile-nav__label">メニュー</span>
      </button>
    </nav>

    <!-- Floating Action Button for quick shopping list access -->
    <button type="button" class="fab" id="fabShopping" hidden aria-label="買い物リストを表示">
      <span class="fab__icon">🛒</span>
      <span class="fab__badge" id="fabBadge" hidden>0</span>
    </button>

    <script src="app.js"></script>
  </body>
</html>
